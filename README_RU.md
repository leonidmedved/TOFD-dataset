# TOFD Defects Dataset

## 1. Общая информация
Датасет предназначен для обучения и валидации нейронных сетей сегментации дефектов по данным TOFD (Time-of-Flight Diffraction).  

Включает:  
- **Синтетические данные** — эхосигналы, рассчитанные в программном комплексе **CIVA** методом лучевых трубок.  
- **Реальные данные** — результаты измерений на образцах со специально созданными дефектами.  

Данные разделены на обучающую и валидационную выборки.  

---

## 2. Структура данных

```
DATASTORES/
│
├── actualdatastore/
│   ├── data_real+civa/          # изображения (train)
│   ├── data_real+civa_val/      # изображения (validation)
│   ├── mask_real+civa/          # маски (train)
│   ├── mask_real+civa_val/      # маски (validation)
│
├── OriginalData/
│   ├── data_base/               # Оригинальные изображения с реальных данных 
│   ├── mask_base/               # Маски изображений реальных данных 
│   ├── civa_base/               # Изображения полученные с помощью CIVA
│   ├── mask_civa/               # Маски изображений полученных с помощью CIVA
│   ├── Data_mix/                # Объедененный набор данных (Реальные данные + CIVA)
│   ├── Mask_mix/                # Маски объедененного набора данных (Реальные данные + CIVA)
```

Загрузка в MATLAB:

```matlab
% Датастор для изображений
ds = imageDatastore('.../data_real+civa','FileExtensions','.png');
dsv = imageDatastore('.../data_real+civa_val','FileExtensions','.png');

% Определение классов и их меток
classNames = ["E","LSUP","LSDN","LBIN","VI","VC","HW","BS"];
labelIDs   = [0,50,100,125,150,200,220,250];

% Датастор для масок
pxds  = pixelLabelDatastore('.../mask_real+civa', classNames, labelIDs);
pxdsv = pixelLabelDatastore('.../mask_real+civa_val', classNames, labelIDs);

% Объединение изображений и масок
pximds  = pixelLabelImageDatastore(ds, pxds);
pximdsv = pixelLabelImageDatastore(dsv, pxdsv);
```

---

## 3. Классы и разметка

| Метка (ID) | Класс   | Тип дефекта                         | Примеры дефектов (реальные)               | Имитация в CIVA                  |
|------------|---------|--------------------------------------|-------------------------------------------|----------------------------------|
| 0          | E       | Отсутствие несплошностей             | —                                         | —                                |
| 50         | LSUP    | Протяженная у поверхности            | Подрез, непровар по кромке                 | Паз, БЦО у наружной поверхности |
| 100        | LSDN    | Протяженная у дна                   | Несплавление корня, утяжина, избыточный проплав | Паз, БЦО у дна, имитация утяжины |
| 125        | LBIN    | Протяженная внутренняя              | Непровар по кромке, межваликовое несплавление | Внутренний паз, БЦО              |
| 150        | VI      | Одиночная объёмная (точечная)       | Шлак, пора, замок                          | Сфера, вертикальное отверстие    |
| 200        | VC      | Скопление объёмных                  | Скопление пор, шлаковых включений, многоэтажный дефект | Скопление сфер (только моделирование) |
| 220        | HW      | Головная волна                      | —                                         | —                                |
| 250        | BS      | Донный сигнал                       | —                                         | —                                |

---

## 4. Синтетические данные (CIVA)

Для численных экспериментов применялись модели эхосигналов, рассчитанные в **CIVA** по теории лучевых трубок.  
Использовались следующие типы дефектов:  

- Придонные трещины  
- Внутренние трещины  
- Приповерхностные трещины  
- Сферические дефекты 
- Боковые цилиндрические отверстия (имитация непроваров)  

**Диапазоны параметров дефектов:**  
- высота: 0.5–20 мм  
- ширина: 2.5–25 мм  

Шум моделировался в виде точечных отражателей, случайно расположенных с плотностью **2 отражателя/мм³**.  

---

## 5. Реальные данные (образцы с дефектами)

Для валидации и тестирования были изготовлены два металлических образца:  

- **Материал**: сталь 20  
- **Толщина**: 25 мм  
- **Каждый образец**: содержит 8 искусственно созданных дефектов  
- **Типы дефектов**:  
  - 6 придонных трещин (пазы)  
  - 6 приповерхностных трещин (пазы)  
  - 4 внутренних трещины (боковые пропилы)  

**Измерения:**  
- Пьезопреобразователи: 5 МГц, Ø6 мм  
- Угол ввода: 60°  
- Установка: с двух сторон каждого образца  
- Шаг сканирования:  
  - по оси X: 0.5 мм  
  - по оси Y: 0.2 мм  
- Всего по Y: 170 наборов эхосигналов  

---

## 6. Пример аугментации (MATLAB)

```matlab
augmenter = imageDataAugmenter( ...
    'RandXTranslation', [-10, 10], ...
    'RandYTranslation', [-10, 10], ...
    'RandScale', [0.85, 1.15]);

pximds = pixelLabelImageDatastore(ds, pxds, ...
    'DataAugmentation', augmenter);
```

---

## 7. Использование
Датасет можно применять для:  
- обучения моделей сегментации (U-Net, U-Net++, Attention U-Net и др.),  
- тестирования устойчивости на синтетике и реальных данных,  
- разработки методов фильтрации сигналов и постобработки.
## 
Данный датасет распространяется по лицензии Creative Commons Attribution-NonCommercial 4.0 International (CC BY-NC 4.0).
Вы можете свободно использовать и изменять данные в исследовательских и образовательных целях,
но их коммерческое использование не допускается.
Подробности см. в файле LICENSE
.
